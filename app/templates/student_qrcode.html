<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>あなたの出欠登録用QRコード | 出欠管理システム</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gray-50">
    <!-- ナビゲーションバー -->
    <nav class="bg-blue-600 shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <a href="{{ url_for('main.index') }}" class="text-white text-xl font-bold">
                        出席管理システム
                    </a>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="text-white">こんにちは、{{ current_user.student_name }}さん</span>
                    <a href="{{ url_for('main.logout') }}" class="text-white hover:text-gray-200 px-3 py-2 rounded-md text-sm font-medium">
                        ログアウト
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- フラッシュメッセージ表示エリア -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="max-w-4xl mx-auto px-4 py-4">
                {% for category, message in messages %}
                    <div class="p-3 rounded {% if category == 'error' %}bg-red-100 text-red-700{% else %}bg-blue-100 text-blue-700{% endif %}">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <!-- メインコンテンツ -->
    <div class="max-w-4xl mx-auto px-4 py-8">
        <div class="bg-white rounded-lg shadow-lg p-8">
            <div class="text-center">
                <h1 class="text-3xl font-bold text-gray-800 mb-2">あなたの出欠登録用QRコード</h1>
                <p class="text-gray-600 mb-8">このQRコードを授業のQRコードリーダーにかざしてください</p>
                
                <!-- QRコード表示エリア -->
                <div class="flex justify-center mb-8">
                    <div class="bg-white p-4 rounded-lg shadow-md border-2 border-gray-200">
                        <img src="{{ url_for('main.student_qrcode_image') }}" 
                             alt="学生QRコード" 
                             class="w-64 h-64 mx-auto"
                             id="qrcode-image">
                    </div>
                </div>
                
                <!-- 学籍番号表示 -->
                <div class="bg-gray-100 rounded-lg p-4 mb-6">
                    <p class="text-sm text-gray-600">学籍番号</p>
                    <p class="text-xl font-mono font-bold text-gray-800">{{ current_user.student_id }}</p>
                </div>
                
                <!-- 使用方法の説明 -->
                <div class="bg-blue-50 rounded-lg p-6 mb-6">
                    <h3 class="text-lg font-semibold text-blue-800 mb-3">使用方法</h3>
                    <ol class="text-left text-blue-700 space-y-2">
                        <li>1. 授業開始時に、このQRコードを表示してください</li>
                        <li>2. 教室のQRコードリーダーにこのQRコードをかざしてください</li>
                        <li>3. 出欠が自動的に記録されます</li>
                    </ol>
                </div>
                
                <!-- アクションボタン -->
                <div class="flex justify-center space-x-4">
                    <button onclick="refreshQRCode()" 
                            class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200">
                        QRコードを更新
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        function refreshQRCode() {
            // QRコード画像を再読み込み
            const img = document.getElementById('qrcode-image');
            img.src = img.src + '?t=' + new Date().getTime();
        }
    </script>
</body>
</html>

